import{d as $,F as j,J as N,K as x,L as B,r as D,t as L,i as M,v as a,x as o,y as e,A as R,B as T,C as V,M as F,N as S,G as m,z as l,I as G}from"./DPxB2w_0.js";import{u as H}from"./Dn_8v55Y.js";import{u as P}from"./LNL3RY7w.js";import{u as z,a as k}from"./DEefp4d8.js";import{u as E,a as I,s as d}from"./Dg45MdiV.js";import{g as J}from"./_kJ-WLyv.js";import"./B8H6CRKA.js";import"./CcbZIe53.js";const K={class:"card"},Q={class:"comments"},q={class:"comment-back"},O={class:"comment-items-wrap"},U={href:"javascript:;",class:"comment-author-avatar-link"},W=["src"],X={class:"comment-content-wrap"},Y={class:"comment-author-wrap"},Z={href:"javascript:;",class:"comment-author"},ee={class:"comment-content"},te={class:"comment-footer"},se={class:"comment-time"},ae=["onClick"],oe=["onClick"],ne={key:0,class:"load-more-wrap"},ce={key:1,href:"javascript:;",class:"comments-load-more"},he=$({name:"BackendArticleComment",__name:"comment",async setup(re){let _,u;const p=j(),f=H("id"),r=P();[_,u]=N(()=>z("backend-article-comment",()=>r.getCommentList({page:1,path:p.fullPath,all:1,id:f.value}))),await _,u();const y=x(r),i=B(y,"lists"),[h,v]=E(!1);async function C(t=i.value.page){h.value||(v(!0),await r.getCommentList({page:t,path:p.fullPath,all:1,id:f.value}),v(!1))}async function w(t){const{code:n,message:c}=await k().$get("/api/frontend/comment/recover",{id:t});n===200&&(d({type:"success",content:c}),r.recoverComment(t))}async function b(t){const{code:n,message:c}=await k().$get("/api/frontend/comment/delete",{id:t});n===200?(d({type:"success",content:c}),r.deleteComment(t)):d(c)}const g=D("评论列表 - M.M.F 小屋");return L({title:g,meta:[{name:"description",content:g}]}),(t,n)=>{const c=M("router-link");return a(),o("div",K,[e("div",Q,[e("div",q,[R(c,{to:"/_backend/article/list",class:"btn btn-blue"},{default:T(()=>[V("返回")]),_:1})]),e("div",O,[(a(!0),o(F,null,S(i.value.data,s=>(a(),o("div",{key:s._id,class:"comment-item"},[e("a",U,[e("img",{src:("useAvatar"in t?t.useAvatar:m(I))(s.email),alt:"",class:"avatar-img"},null,8,W)]),e("div",X,[e("span",Y,[e("a",Z,l(s.username),1)]),e("div",ee,l(s.content),1),e("div",te,[e("span",se,l(m(J)(`${s.timestamp}`)),1),s.is_delete?(a(),o("a",{key:0,href:"javascript:;",class:"comment-action-item comment-reply",onClick:A=>w(s._id)},"恢复",8,ae)):(a(),o("a",{key:1,href:"javascript:;",class:"comment-action-item comment-reply",onClick:A=>b(s._id)},"删除",8,oe))])])]))),128))]),i.value.hasNext?(a(),o("div",ne,[m(h)?(a(),o("a",ce,"加载中...")):(a(),o("a",{key:0,href:"javascript:;",class:"comments-load-more",onClick:n[0]||(n[0]=s=>C())},"加载更多"))])):G("",!0)])])}}});export{he as default};
